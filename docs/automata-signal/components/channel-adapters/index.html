<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-automata-signal/components/channel-adapters" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">[COMP-002] 채널 어댑터 시스템 | Automata</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://AutomataOOO.github.io/automata_docs/docs/automata-signal/components/channel-adapters"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="[COMP-002] 채널 어댑터 시스템 | Automata"><meta data-rh="true" name="description" content="| 버전 | 날짜       | 변경 내용      |"><meta data-rh="true" property="og:description" content="| 버전 | 날짜       | 변경 내용      |"><link data-rh="true" rel="icon" href="/automata_docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://AutomataOOO.github.io/automata_docs/docs/automata-signal/components/channel-adapters"><link data-rh="true" rel="alternate" href="https://AutomataOOO.github.io/automata_docs/docs/automata-signal/components/channel-adapters" hreflang="en"><link data-rh="true" rel="alternate" href="https://AutomataOOO.github.io/automata_docs/docs/automata-signal/components/channel-adapters" hreflang="x-default"><link rel="stylesheet" href="/automata_docs/assets/css/styles.7a5bbb8d.css">
<script src="/automata_docs/assets/js/runtime~main.21614994.js" defer="defer"></script>
<script src="/automata_docs/assets/js/main.bf7d6add.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/automata_docs/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/automata_docs/"><div class="navbar__logo"><img src="/automata_docs/img/logo.svg" alt="Automata Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/automata_docs/img/logo.svg" alt="Automata Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Automata</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/automata_docs/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/automata_docs/docs/">Summary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/automata_docs/docs/automata-signal/">Automata-Signal</a><button aria-label="Collapse sidebar category &#x27;Automata-Signal&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/automata_docs/docs/automata-signal/architectures/overview">architectures</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/automata_docs/docs/automata-signal/components/channel-adapters">components</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/automata_docs/docs/automata-signal/components/channel-adapters">[COMP-002] 채널 어댑터 시스템</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/automata_docs/docs/automata-signal/dictionaries/message-states">dictionaries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/automata_docs/docs/automata-signal/flows/message-processing-flow">flows</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/automata_docs/docs/automata-signal/requirements">[REQ-001] Automata-Signal 요구사항</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/automata_docs/docs/automata-signal/workspace-rules">Workspace rules - Automata-Signal</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/automata_docs/docs/global-rules">Global rules</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/automata_docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/automata_docs/docs/automata-signal/"><span itemprop="name">Automata-Signal</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">components</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">[COMP-002] 채널 어댑터 시스템</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>[COMP-002] 채널 어댑터 시스템</h1></header>
<table><thead><tr><th>버전</th><th>날짜</th><th>변경 내용</th></tr></thead><tbody><tr><td>1.0</td><td>2025-04-02</td><td>최초 문서 작성</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="관련-문서">관련 문서<a href="#관련-문서" class="hash-link" aria-label="Direct link to 관련 문서" title="Direct link to 관련 문서">​</a></h2>
<ul>
<li>[ARCH-001] 아키텍처 개요</li>
<li>[DICT-001] 구독 상태 코드 사전</li>
<li>[DICT-003] 메시지 상태 및 전이 규칙</li>
<li>[FLOW-002] 메시지 처리 흐름</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="요약">요약<a href="#요약" class="hash-link" aria-label="Direct link to 요약" title="Direct link to 요약">​</a></h2>
<p>본 문서는 Automata-Signal의 채널 어댑터 시스템에 대한 상세 설계와 구현 방법을 설명합니다. 채널 어댑터는 다양한 메시징 채널(푸시 알림, 이메일, SMS 등)과의 통합을 담당하는 모듈화된 컴포넌트입니다. 확장 가능하고 유지보수가 용이한 설계를 통해 새로운 채널을 쉽게 추가할 수 있습니다.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="대상-독자">대상 독자<a href="#대상-독자" class="hash-link" aria-label="Direct link to 대상 독자" title="Direct link to 대상 독자">​</a></h2>
<ul>
<li>백엔드 개발자</li>
<li>시스템 아키텍트</li>
<li>채널 통합 담당자</li>
<li>QA 엔지니어</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="선행-지식">선행 지식<a href="#선행-지식" class="hash-link" aria-label="Direct link to 선행 지식" title="Direct link to 선행 지식">​</a></h2>
<ul>
<li>[ARCH-001] 아키텍처 개요</li>
<li>[DICT-001] 구독 상태 코드 사전</li>
<li>[DICT-003] 메시지 상태 및 전이 규칙</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-어댑터-시스템-개요">1. 어댑터 시스템 개요<a href="#1-어댑터-시스템-개요" class="hash-link" aria-label="Direct link to 1. 어댑터 시스템 개요" title="Direct link to 1. 어댑터 시스템 개요">​</a></h2>
<p>채널 어댑터 시스템은 다양한 메시징 채널과의 통합을 일관된 인터페이스로 추상화하는 핵심 컴포넌트입니다. 이를 통해 메시지 처리 코어 시스템은 각 채널의 특성과 구현 세부사항을 알 필요 없이 표준화된 방식으로 메시지를 전송할 수 있습니다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-주요-목표">1.1 주요 목표<a href="#11-주요-목표" class="hash-link" aria-label="Direct link to 1.1 주요 목표" title="Direct link to 1.1 주요 목표">​</a></h3>
<ul>
<li><strong>일관된 인터페이스</strong>: 모든 채널에 대해 동일한 메시지 전송 인터페이스 제공</li>
<li><strong>확장성</strong>: 새로운 채널을 최소한의 코드 변경으로 추가 가능</li>
<li><strong>채널 독립성</strong>: 각 채널의 구현이 다른 채널에 영향을 주지 않음</li>
<li><strong>오류 처리 통합</strong>: 다양한 채널별 오류를 표준화된 형식으로 변환</li>
<li><strong>성능 최적화</strong>: 각 채널별 최적화된 전송 전략 적용</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-채널-어댑터-아키텍처-다이어그램">1.2 채널 어댑터 아키텍처 다이어그램<a href="#12-채널-어댑터-아키텍처-다이어그램" class="hash-link" aria-label="Direct link to 1.2 채널 어댑터 아키텍처 다이어그램" title="Direct link to 1.2 채널 어댑터 아키텍처 다이어그램">​</a></h3>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-어댑터-인터페이스">2. 어댑터 인터페이스<a href="#2-어댑터-인터페이스" class="hash-link" aria-label="Direct link to 2. 어댑터 인터페이스" title="Direct link to 2. 어댑터 인터페이스">​</a></h2>
<p>모든 채널 어댑터는 다음과 같은 공통 인터페이스를 구현합니다:</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.ChannelAdapter do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @callback send_message(message :: AutomataSignal.Resources.Message.t()) ::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:ok, map()} | {:error, map()}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @callback validate_message(message :: AutomataSignal.Resources.Message.t()) ::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    :ok | {:error, reason :: atom(), details :: map()}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @callback get_status(message_id :: String.t()) ::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:ok, status :: atom()} | {:error, reason :: atom()}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @callback map_error(error :: any()) ::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:permanent, reason :: atom(), details :: map()} |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:temporary, reason :: atom(), details :: map()}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-인터페이스-메서드-설명">2.1 인터페이스 메서드 설명<a href="#21-인터페이스-메서드-설명" class="hash-link" aria-label="Direct link to 2.1 인터페이스 메서드 설명" title="Direct link to 2.1 인터페이스 메서드 설명">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="211-send_message1">2.1.1 send_message/1<a href="#211-send_message1" class="hash-link" aria-label="Direct link to 2.1.1 send_message/1" title="Direct link to 2.1.1 send_message/1">​</a></h4>
<p>메시지를 해당 채널을 통해 전송하는 핵심 메서드입니다.</p>
<ul>
<li><strong>입력</strong>: <code>Message</code> 구조체 (제목, 본문, 데이터, 구독 정보 등)</li>
<li><strong>출력</strong>: 성공 시 <code>{:ok, response_data}</code>, 실패 시 <code>{:error, error_data}</code></li>
<li><strong>책임</strong>:<!-- -->
<ul>
<li>메시지를 채널에 맞는 형식으로 변환</li>
<li>외부 서비스 API 호출</li>
<li>응답 처리 및 결과 반환</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="212-validate_message1">2.1.2 validate_message/1<a href="#212-validate_message1" class="hash-link" aria-label="Direct link to 2.1.2 validate_message/1" title="Direct link to 2.1.2 validate_message/1">​</a></h4>
<p>메시지가 해당 채널에 적합한지 검증하는 메서드입니다.</p>
<ul>
<li><strong>입력</strong>: <code>Message</code> 구조체</li>
<li><strong>출력</strong>: 유효 시 <code>:ok</code>, 무효 시 <code>{:error, reason, details}</code></li>
<li><strong>책임</strong>:<!-- -->
<ul>
<li>필수 필드 검증</li>
<li>채널별 제한사항 검사 (길이, 형식 등)</li>
<li>유효하지 않은 경우 상세 오류 정보 제공</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="213-get_status1">2.1.3 get_status/1<a href="#213-get_status1" class="hash-link" aria-label="Direct link to 2.1.3 get_status/1" title="Direct link to 2.1.3 get_status/1">​</a></h4>
<p>특정 메시지의 현재 상태를 조회하는 메서드입니다.</p>
<ul>
<li><strong>입력</strong>: 메시지 ID (채널별 고유 식별자)</li>
<li><strong>출력</strong>: 성공 시 <code>{:ok, status}</code>, 실패 시 <code>{:error, reason}</code></li>
<li><strong>책임</strong>:<!-- -->
<ul>
<li>외부 서비스 API를 통한 상태 조회</li>
<li>표준화된 상태값으로 변환</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="214-map_error1">2.1.4 map_error/1<a href="#214-map_error1" class="hash-link" aria-label="Direct link to 2.1.4 map_error/1" title="Direct link to 2.1.4 map_error/1">​</a></h4>
<p>채널별 오류를 표준화된 형식으로 변환하는 메서드입니다.</p>
<ul>
<li><strong>입력</strong>: 채널 특정 오류 객체/메시지</li>
<li><strong>출력</strong>: <code>{:permanent, reason, details}</code> 또는 <code>{:temporary, reason, details}</code></li>
<li><strong>책임</strong>:<!-- -->
<ul>
<li>영구적/일시적 오류 분류</li>
<li>오류 코드 및 메시지 표준화</li>
<li>구독 상태 코드 매핑</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-채널-어댑터-구현">3. 채널 어댑터 구현<a href="#3-채널-어댑터-구현" class="hash-link" aria-label="Direct link to 3. 채널 어댑터 구현" title="Direct link to 3. 채널 어댑터 구현">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-푸시-알림-어댑터">3.1 푸시 알림 어댑터<a href="#31-푸시-알림-어댑터" class="hash-link" aria-label="Direct link to 3.1 푸시 알림 어댑터" title="Direct link to 3.1 푸시 알림 어댑터">​</a></h3>
<p>푸시 알림 어댑터는 iOS(APNS)와 Android(FCM) 플랫폼 모두를 지원합니다.</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.PushAdapter do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @behaviour AutomataSignal.Adapters.ChannelAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Subscription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # APNS 설정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @apns_config %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cert: {:file, &quot;path/to/cert.pem&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    key: {:file, &quot;path/to/key.pem&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mode: :prod  # :dev 또는 :prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # FCM 설정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @fcm_config %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    key: &quot;your_server_key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def send_message(%Message{subscription: subscription} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 메시지 검증</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case validate_message(message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      :ok -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # 구독 유형에 따라 적절한 전송 방법 선택</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        case subscription.type do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          :iOSPush -&gt; send_ios_message(message)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          :AndroidPush -&gt; send_android_message(message)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          _ -&gt; {:error, %{reason: :invalid_subscription_type}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      error -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def validate_message(%Message{} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cond do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      is_nil(message.title) and is_nil(message.body) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :missing_content, %{message: &quot;Both title and body cannot be empty&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      byte_size(message.title || &quot;&quot;) &gt; 150 -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :title_too_long, %{message: &quot;Title exceeds maximum length (150 bytes)&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      byte_size(message.body || &quot;&quot;) &gt; 4000 -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :body_too_long, %{message: &quot;Body exceeds maximum length (4000 bytes)&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      is_nil(message.subscription) or is_nil(message.subscription.token) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :missing_token, %{message: &quot;Push token is required&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      true -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        :ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def get_status(message_id) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 대부분의 푸시 서비스는 상태 조회 API를 제공하지 않으므로</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 로컬 상태 저장소에서 조회</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:error, :not_supported}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def map_error(error) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case error do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # APNS 오류 매핑</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      %{reason: &quot;BadDeviceToken&quot;} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:permanent, :invalid_token, %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          code: &quot;BadDeviceToken&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          subscription_status: -10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      %{reason: &quot;DeviceTokenNotForTopic&quot;} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:permanent, :token_topic_mismatch, %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          code: &quot;DeviceTokenNotForTopic&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          subscription_status: -14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # FCM 오류 매핑</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      %{error: &quot;NotRegistered&quot;} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:permanent, :unregistered, %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          code: &quot;NotRegistered&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          subscription_status: -10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      %{error: &quot;InvalidRegistration&quot;} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:permanent, :invalid_token, %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          code: &quot;InvalidRegistration&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          subscription_status: -4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # 서비스 일시적 오류</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      %{status: code} when code &gt;= 500 -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:temporary, :server_error, %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          code: &quot;ServerError&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          status: code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # 기본 오류 처리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      _ -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:permanent, :unknown_error, %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          original_error: inspect(error)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 내부 헬퍼 메서드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp send_ios_message(%Message{} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    notification = %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      token: message.subscription.token,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      topic: get_bundle_id(message.application),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      notification: %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        title: message.title,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        body: message.body</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      custom: message.data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case Pigeon.APNS.push(notification, get_apns_config(message.subscription)) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {:ok, data} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:ok, %{provider_message_id: data.id}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {:error, reason} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, reason}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp send_android_message(%Message{} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    notification = %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      to: message.subscription.token,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      notification: %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        title: message.title,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        body: message.body</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      data: message.data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case Pigeon.FCM.push(notification) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {:ok, data} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:ok, %{provider_message_id: data.id}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {:error, reason} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, reason}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 디바이스의 test_type에 따라 APNS 환경 결정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp get_apns_config(%Subscription{test_type: 1}), do: %{@apns_config | mode: :dev}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp get_apns_config(%Subscription{test_type: 2}), do: %{@apns_config | mode: :dev}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp get_apns_config(_), do: @apns_config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp get_bundle_id(application) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 앱 설정에서 번들 ID 조회 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    application.settings[&quot;ios_bundle_id&quot;] || &quot;com.default.app&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-이메일-어댑터-지원-예정">3.2 이메일 어댑터 (지원 예정)<a href="#32-이메일-어댑터-지원-예정" class="hash-link" aria-label="Direct link to 3.2 이메일 어댑터 (지원 예정)" title="Direct link to 3.2 이메일 어댑터 (지원 예정)">​</a></h3>
<p>이메일 어댑터는 SMTP 또는 AWS SES와 같은 이메일 서비스와 통합됩니다.</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.EmailAdapter do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @behaviour AutomataSignal.Adapters.ChannelAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def send_message(%Message{subscription: %{type: :Email, token: email}} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:error, %{reason: :not_implemented_yet}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def validate_message(%Message{} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cond do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      is_nil(message.title) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :missing_subject, %{message: &quot;Email subject is required&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      is_nil(message.body) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :missing_body, %{message: &quot;Email body is required&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # 이메일 형식 검증</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      not valid_email?(message.subscription.token) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :invalid_email, %{message: &quot;Invalid email format&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      true -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        :ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def get_status(_message_id) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:error, :not_implemented_yet}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def map_error(_error) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:permanent, :not_implemented_yet, %{}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 내부 헬퍼 메서드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp valid_email?(email) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 간단한 이메일 형식 검증 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Regex.match?(~r/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/, email)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-sms-어댑터-지원-예정">3.3 SMS 어댑터 (지원 예정)<a href="#33-sms-어댑터-지원-예정" class="hash-link" aria-label="Direct link to 3.3 SMS 어댑터 (지원 예정)" title="Direct link to 3.3 SMS 어댑터 (지원 예정)">​</a></h3>
<p>SMS 어댑터는 다양한 SMS 게이트웨이와 통합됩니다.</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.SMSAdapter do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @behaviour AutomataSignal.Adapters.ChannelAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def send_message(%Message{subscription: %{type: :SMS, token: phone_number}} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:error, %{reason: :not_implemented_yet}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def validate_message(%Message{} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cond do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      is_nil(message.body) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :missing_body, %{message: &quot;SMS body is required&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      byte_size(message.body) &gt; 160 -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :body_too_long, %{message: &quot;SMS body exceeds 160 characters&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # 전화번호 형식 검증</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      not valid_phone_number?(message.subscription.token) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :invalid_phone_number, %{message: &quot;Invalid phone number format&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      true -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        :ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def get_status(_message_id) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:error, :not_implemented_yet}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def map_error(_error) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:permanent, :not_implemented_yet, %{}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 내부 헬퍼 메서드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp valid_phone_number?(phone) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 간단한 전화번호 형식 검증 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Regex.match?(~r/^\+?[0-9]{10,15}$/, phone)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-카카오-알림톡-어댑터-지원-예정">3.4 카카오 알림톡 어댑터 (지원 예정)<a href="#34-카카오-알림톡-어댑터-지원-예정" class="hash-link" aria-label="Direct link to 3.4 카카오 알림톡 어댑터 (지원 예정)" title="Direct link to 3.4 카카오 알림톡 어댑터 (지원 예정)">​</a></h3>
<p>카카오 알림톡 어댑터는 카카오 비즈니스 API와 통합됩니다.</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.KakaoAdapter do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @behaviour AutomataSignal.Adapters.ChannelAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def send_message(%Message{subscription: %{type: :KakaoTalk, token: phone_number}} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:error, %{reason: :not_implemented_yet}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def validate_message(%Message{} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cond do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      is_nil(message.data) || is_nil(message.data[&quot;template_code&quot;]) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :missing_template, %{message: &quot;Kakao template code is required&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # 템플릿 변수 검증</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      not valid_template_variables?(message.data) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :invalid_template_variables, %{message: &quot;Invalid template variables&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      true -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        :ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def get_status(_message_id) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:error, :not_implemented_yet}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def map_error(_error) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:permanent, :not_implemented_yet, %{}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 내부 헬퍼 메서드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp valid_template_variables?(data) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 템플릿 변수 검증 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="35-인앱-메시지-어댑터-지원-예정">3.5 인앱 메시지 어댑터 (지원 예정)<a href="#35-인앱-메시지-어댑터-지원-예정" class="hash-link" aria-label="Direct link to 3.5 인앱 메시지 어댑터 (지원 예정)" title="Direct link to 3.5 인앱 메시지 어댑터 (지원 예정)">​</a></h3>
<p>인앱 메시지 어댑터는 클라이언트 SDK와 통합됩니다.</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.InAppAdapter do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @behaviour AutomataSignal.Adapters.ChannelAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def send_message(%Message{subscription: %{type: :InAppMessage}} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:error, %{reason: :not_implemented_yet}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def validate_message(%Message{} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cond do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      is_nil(message.title) and is_nil(message.body) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :missing_content, %{message: &quot;Both title and body cannot be empty&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      is_nil(message.data) || is_nil(message.data[&quot;layout_type&quot;]) -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {:error, :missing_layout, %{message: &quot;Layout type is required for in-app messages&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      true -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        :ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def get_status(_message_id) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:error, :not_implemented_yet}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def map_error(_error) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 향후 구현 예정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:permanent, :not_implemented_yet, %{}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-어댑터-팩토리">4. 어댑터 팩토리<a href="#4-어댑터-팩토리" class="hash-link" aria-label="Direct link to 4. 어댑터 팩토리" title="Direct link to 4. 어댑터 팩토리">​</a></h2>
<p>어댑터 팩토리는 메시지나 구독 정보를 기반으로 적절한 채널 어댑터를 선택하는 역할을 합니다.</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.AdapterFactory do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Subscription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Adapters.PushAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Adapters.EmailAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Adapters.SMSAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Adapters.KakaoAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Adapters.InAppAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @doc &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  구독 정보를 기반으로 적절한 채널 어댑터를 반환합니다.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def get_adapter_for_subscription(%Subscription{type: type}) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    get_adapter_for_channel_type(type)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @doc &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  채널 유형을 기반으로 적절한 채널 어댑터를 반환합니다.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def get_adapter_for_channel_type(channel_type) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case channel_type do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      :iOSPush -&gt; PushAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      :AndroidPush -&gt; PushAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      :Email -&gt; EmailAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      :SMS -&gt; SMSAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      :KakaoTalk -&gt; KakaoAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      :InAppMessage -&gt; InAppAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      _ -&gt; raise &quot;Unsupported channel type: #{inspect(channel_type)}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @doc &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  메시지 객체를 기반으로 적절한 채널 어댑터를 반환합니다.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def get_adapter_for_message(%Message{subscription: subscription}) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    get_adapter_for_subscription(subscription)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-메시지-전송-프로세스">5. 메시지 전송 프로세스<a href="#5-메시지-전송-프로세스" class="hash-link" aria-label="Direct link to 5. 메시지 전송 프로세스" title="Direct link to 5. 메시지 전송 프로세스">​</a></h2>
<p>어댑터 시스템을 사용한 메시지 전송 프로세스는 다음과 같습니다:</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Services.MessageService do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Adapters.AdapterFactory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @doc &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  메시지를 적절한 채널을 통해 전송합니다.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def send_message(%Message{} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 메시지에 맞는 어댑터 선택</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    adapter = AdapterFactory.get_adapter_for_message(message)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 메시지 검증</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case adapter.validate_message(message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      :ok -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # 메시지 전송</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        case adapter.send_message(message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {:ok, response} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            # 성공 처리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            update_message_status(message, :successful, response)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          {:error, error} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            # 오류 처리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            handle_send_error(message, adapter, error)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {:error, reason, details} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # 검증 오류 처리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        update_message_status(message, :failed, %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          error_reason: reason,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          error_details: details</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 메시지 상태 업데이트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp update_message_status(message, status, details) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ... 메시지 상태 업데이트 로직 ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 전송 오류 처리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp handle_send_error(message, adapter, error) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 오류 매핑</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    case adapter.map_error(error) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {:permanent, reason, details} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # 영구적 오류 - 재시도 없음</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        update_message_status(message, :failed, %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          error_reason: reason,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          error_details: details</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {:temporary, reason, details} -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # 일시적 오류 - 재시도 스케줄링</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        update_message_status(message, :errored, %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          error_reason: reason,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          error_details: details</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        schedule_retry(message)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 메시지 재시도 스케줄링</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defp schedule_retry(message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ... 재시도 스케줄링 로직 ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-어댑터-확장-가이드">6. 어댑터 확장 가이드<a href="#6-어댑터-확장-가이드" class="hash-link" aria-label="Direct link to 6. 어댑터 확장 가이드" title="Direct link to 6. 어댑터 확장 가이드">​</a></h2>
<p>새로운 메시징 채널을 추가하기 위한 어댑터 구현 가이드입니다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-기본-구현-단계">6.1 기본 구현 단계<a href="#61-기본-구현-단계" class="hash-link" aria-label="Direct link to 6.1 기본 구현 단계" title="Direct link to 6.1 기본 구현 단계">​</a></h3>
<ol>
<li><code>ChannelAdapter</code> 비헤이비어를 구현하는 새 모듈 생성</li>
<li>필수 콜백 메서드 구현:<!-- -->
<ul>
<li><code>send_message/1</code></li>
<li><code>validate_message/1</code></li>
<li><code>get_status/1</code></li>
<li><code>map_error/1</code></li>
</ul>
</li>
<li>채널별 특화 로직 구현 (메시지 변환, API 호출 등)</li>
<li><code>AdapterFactory</code>에 새 채널 유형 및 어댑터 추가</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-새-어댑터-구현-예시">6.2 새 어댑터 구현 예시<a href="#62-새-어댑터-구현-예시" class="hash-link" aria-label="Direct link to 6.2 새 어댑터 구현 예시" title="Direct link to 6.2 새 어댑터 구현 예시">​</a></h3>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.WebPushAdapter do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @behaviour AutomataSignal.Adapters.ChannelAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def send_message(%Message{subscription: %{type: :WebPush, token: subscription_info}} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Web Push API 통합 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def validate_message(%Message{} = message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Web Push 메시지 검증 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def get_status(message_id) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 상태 조회 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def map_error(error) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Web Push 특화 오류 매핑</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="63-adapterfactory-업데이트">6.3 AdapterFactory 업데이트<a href="#63-adapterfactory-업데이트" class="hash-link" aria-label="Direct link to 6.3 AdapterFactory 업데이트" title="Direct link to 6.3 AdapterFactory 업데이트">​</a></h3>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># AdapterFactory에 새 채널 유형 추가</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def get_adapter_for_channel_type(channel_type) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  case channel_type do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ... 기존 채널 ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    :WebPush -&gt; WebPushAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ -&gt; raise &quot;Unsupported channel type: #{inspect(channel_type)}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="64-새-구독-유형-추가">6.4 새 구독 유형 추가<a href="#64-새-구독-유형-추가" class="hash-link" aria-label="Direct link to 6.4 새 구독 유형 추가" title="Direct link to 6.4 새 구독 유형 추가">​</a></h3>
<p>데이터베이스 스키마에 새 구독 유형을 추가해야 합니다:</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Subscription 리소스 업데이트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">attribute :type, :atom do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  constraints [one_of: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    :iOSPush, :AndroidPush, :Email, :SMS, :KakaoTalk, :InAppMessage, :WebPush</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-성능-및-확장성-고려사항">7. 성능 및 확장성 고려사항<a href="#7-성능-및-확장성-고려사항" class="hash-link" aria-label="Direct link to 7. 성능 및 확장성 고려사항" title="Direct link to 7. 성능 및 확장성 고려사항">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="71-연결-풀링">7.1 연결 풀링<a href="#71-연결-풀링" class="hash-link" aria-label="Direct link to 7.1 연결 풀링" title="Direct link to 7.1 연결 풀링">​</a></h3>
<p>외부 서비스와의 연결을 효율적으로 관리하기 위한 연결 풀링:</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.ConnectionPool do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  use GenServer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 풀 관리 및 연결 재사용 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="72-비율-제한-처리">7.2 비율 제한 처리<a href="#72-비율-제한-처리" class="hash-link" aria-label="Direct link to 7.2 비율 제한 처리" title="Direct link to 7.2 비율 제한 처리">​</a></h3>
<p>API 비율 제한을 관리하기 위한 전략:</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.RateLimiter do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  use GenServer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 채널별 비율 제한 처리 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="73-배치-처리">7.3 배치 처리<a href="#73-배치-처리" class="hash-link" aria-label="Direct link to 7.3 배치 처리" title="Direct link to 7.3 배치 처리">​</a></h3>
<p>대량 메시지 전송을 위한 배치 처리:</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.BatchProcessor do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 메시지 그룹화 및 배치 전송 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-모니터링-및-지표">8. 모니터링 및 지표<a href="#8-모니터링-및-지표" class="hash-link" aria-label="Direct link to 8. 모니터링 및 지표" title="Direct link to 8. 모니터링 및 지표">​</a></h2>
<p>어댑터 시스템의 상태 및 성능을 모니터링하기 위한 지표:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="81-성능-지표">8.1 성능 지표<a href="#81-성능-지표" class="hash-link" aria-label="Direct link to 8.1 성능 지표" title="Direct link to 8.1 성능 지표">​</a></h3>
<ul>
<li><strong>전송 시간</strong>: 채널별 평균/최대/최소 전송 시간</li>
<li><strong>성공률</strong>: 채널별 성공적인 전송 비율</li>
<li><strong>오류 비율</strong>: 채널별 오류 유형 분포</li>
<li><strong>재시도 비율</strong>: 임시 오류로 인한 재시도 비율</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="82-운영-지표">8.2 운영 지표<a href="#82-운영-지표" class="hash-link" aria-label="Direct link to 8.2 운영 지표" title="Direct link to 8.2 운영 지표">​</a></h3>
<ul>
<li><strong>채널별 사용량</strong>: 시간별/일별 채널 사용 통계</li>
<li><strong>연결 풀 상태</strong>: 활성/유휴/최대 연결 수</li>
<li><strong>비율 제한 상태</strong>: 채널별 비율 제한 히트 횟수</li>
<li><strong>외부 서비스 가용성</strong>: 채널별 외부 서비스 상태</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="83-로깅-전략">8.3 로깅 전략<a href="#83-로깅-전략" class="hash-link" aria-label="Direct link to 8.3 로깅 전략" title="Direct link to 8.3 로깅 전략">​</a></h3>
<p>각 어댑터는 다음과 같은 이벤트를 로깅합니다:</p>
<ul>
<li>메시지 전송 시도</li>
<li>전송 성공/실패</li>
<li>외부 서비스 응답 (요약)</li>
<li>오류 및 예외 상황</li>
<li>비율 제한 히트</li>
<li>연결 풀 상태 변경</li>
</ul>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.Logger do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def log_message_send(adapter_type, message_id, result) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 메시지 전송 로깅 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def log_error(adapter_type, message_id, error) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 오류 로깅 로직</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # ... 기타 로깅 함수 ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-테스트-전략">9. 테스트 전략<a href="#9-테스트-전략" class="hash-link" aria-label="Direct link to 9. 테스트 전략" title="Direct link to 9. 테스트 전략">​</a></h2>
<p>어댑터 시스템을 위한 테스트 전략:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="91-단위-테스트">9.1 단위 테스트<a href="#91-단위-테스트" class="hash-link" aria-label="Direct link to 9.1 단위 테스트" title="Direct link to 9.1 단위 테스트">​</a></h3>
<p>각 어댑터의 기능을 격리하여 테스트:</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.PushAdapterTest do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  use ExUnit.Case</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Adapters.PushAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Resources.Subscription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 메시지 검증 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  test &quot;validate_message/1 returns :ok for valid messages&quot; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    message = %Message{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      title: &quot;Test Title&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      body: &quot;Test Body&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      subscription: %Subscription{type: :iOSPush, token: &quot;valid_token&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assert PushAdapter.validate_message(message) == :ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 오류 매핑 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  test &quot;map_error/1 correctly maps APNS errors&quot; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error = %{reason: &quot;BadDeviceToken&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    assert PushAdapter.map_error(error) == {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      :permanent,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      :invalid_token,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      %{code: &quot;BadDeviceToken&quot;, subscription_status: -10}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # ... 기타 테스트 ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="92-통합-테스트">9.2 통합 테스트<a href="#92-통합-테스트" class="hash-link" aria-label="Direct link to 9.2 통합 테스트" title="Direct link to 9.2 통합 테스트">​</a></h3>
<p>어댑터와 실제 외부 서비스의 통합을 테스트:</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.PushAdapterIntegrationTest do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  use ExUnit.Case</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  alias AutomataSignal.Adapters.PushAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 실제 테스트 토큰을 사용한 전송 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @tag :integration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  test &quot;send_message/1 successfully sends to test device&quot; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # ... 기타 통합 테스트 ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="93-모의-어댑터">9.3 모의 어댑터<a href="#93-모의-어댑터" class="hash-link" aria-label="Direct link to 9.3 모의 어댑터" title="Direct link to 9.3 모의 어댑터">​</a></h3>
<p>테스트 환경을 위한 모의 어댑터 구현:</p>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule AutomataSignal.Adapters.MockAdapter do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @behaviour AutomataSignal.Adapters.ChannelAdapter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def send_message(message) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 메시지 ID를 기반으로 성공/실패 시뮬레이션</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # ... 기타 콜백 구현 ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/AutomataOOO/automata_docs/tree/main/docs/automata-signal/components/channel-adapters.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/automata_docs/docs/automata-signal/architectures/overview"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">[ARCH-001] Automata-Signal 아키텍처 개요</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/automata_docs/docs/automata-signal/dictionaries/message-states"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">[DICT-003] 메시지 상태 및 전이 규칙</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#관련-문서" class="table-of-contents__link toc-highlight">관련 문서</a></li><li><a href="#요약" class="table-of-contents__link toc-highlight">요약</a></li><li><a href="#대상-독자" class="table-of-contents__link toc-highlight">대상 독자</a></li><li><a href="#선행-지식" class="table-of-contents__link toc-highlight">선행 지식</a></li><li><a href="#1-어댑터-시스템-개요" class="table-of-contents__link toc-highlight">1. 어댑터 시스템 개요</a><ul><li><a href="#11-주요-목표" class="table-of-contents__link toc-highlight">1.1 주요 목표</a></li><li><a href="#12-채널-어댑터-아키텍처-다이어그램" class="table-of-contents__link toc-highlight">1.2 채널 어댑터 아키텍처 다이어그램</a></li></ul></li><li><a href="#2-어댑터-인터페이스" class="table-of-contents__link toc-highlight">2. 어댑터 인터페이스</a><ul><li><a href="#21-인터페이스-메서드-설명" class="table-of-contents__link toc-highlight">2.1 인터페이스 메서드 설명</a></li></ul></li><li><a href="#3-채널-어댑터-구현" class="table-of-contents__link toc-highlight">3. 채널 어댑터 구현</a><ul><li><a href="#31-푸시-알림-어댑터" class="table-of-contents__link toc-highlight">3.1 푸시 알림 어댑터</a></li><li><a href="#32-이메일-어댑터-지원-예정" class="table-of-contents__link toc-highlight">3.2 이메일 어댑터 (지원 예정)</a></li><li><a href="#33-sms-어댑터-지원-예정" class="table-of-contents__link toc-highlight">3.3 SMS 어댑터 (지원 예정)</a></li><li><a href="#34-카카오-알림톡-어댑터-지원-예정" class="table-of-contents__link toc-highlight">3.4 카카오 알림톡 어댑터 (지원 예정)</a></li><li><a href="#35-인앱-메시지-어댑터-지원-예정" class="table-of-contents__link toc-highlight">3.5 인앱 메시지 어댑터 (지원 예정)</a></li></ul></li><li><a href="#4-어댑터-팩토리" class="table-of-contents__link toc-highlight">4. 어댑터 팩토리</a></li><li><a href="#5-메시지-전송-프로세스" class="table-of-contents__link toc-highlight">5. 메시지 전송 프로세스</a></li><li><a href="#6-어댑터-확장-가이드" class="table-of-contents__link toc-highlight">6. 어댑터 확장 가이드</a><ul><li><a href="#61-기본-구현-단계" class="table-of-contents__link toc-highlight">6.1 기본 구현 단계</a></li><li><a href="#62-새-어댑터-구현-예시" class="table-of-contents__link toc-highlight">6.2 새 어댑터 구현 예시</a></li><li><a href="#63-adapterfactory-업데이트" class="table-of-contents__link toc-highlight">6.3 AdapterFactory 업데이트</a></li><li><a href="#64-새-구독-유형-추가" class="table-of-contents__link toc-highlight">6.4 새 구독 유형 추가</a></li></ul></li><li><a href="#7-성능-및-확장성-고려사항" class="table-of-contents__link toc-highlight">7. 성능 및 확장성 고려사항</a><ul><li><a href="#71-연결-풀링" class="table-of-contents__link toc-highlight">7.1 연결 풀링</a></li><li><a href="#72-비율-제한-처리" class="table-of-contents__link toc-highlight">7.2 비율 제한 처리</a></li><li><a href="#73-배치-처리" class="table-of-contents__link toc-highlight">7.3 배치 처리</a></li></ul></li><li><a href="#8-모니터링-및-지표" class="table-of-contents__link toc-highlight">8. 모니터링 및 지표</a><ul><li><a href="#81-성능-지표" class="table-of-contents__link toc-highlight">8.1 성능 지표</a></li><li><a href="#82-운영-지표" class="table-of-contents__link toc-highlight">8.2 운영 지표</a></li><li><a href="#83-로깅-전략" class="table-of-contents__link toc-highlight">8.3 로깅 전략</a></li></ul></li><li><a href="#9-테스트-전략" class="table-of-contents__link toc-highlight">9. 테스트 전략</a><ul><li><a href="#91-단위-테스트" class="table-of-contents__link toc-highlight">9.1 단위 테스트</a></li><li><a href="#92-통합-테스트" class="table-of-contents__link toc-highlight">9.2 통합 테스트</a></li><li><a href="#93-모의-어댑터" class="table-of-contents__link toc-highlight">9.3 모의 어댑터</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Automata, Inc.</div></div></div></footer></div>
</body>
</html>