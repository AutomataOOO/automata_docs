<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-automata-signal/flows/sdk-initialization-flow" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">[FLOW-001] SDK 초기화 및 사용자 식별 흐름 | Automata</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://AutomataOOO.github.io/automata_docs/docs/automata-signal/flows/sdk-initialization-flow"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="[FLOW-001] SDK 초기화 및 사용자 식별 흐름 | Automata"><meta data-rh="true" name="description" content="- 문서 ID: FLOW-001"><meta data-rh="true" property="og:description" content="- 문서 ID: FLOW-001"><link data-rh="true" rel="icon" href="/automata_docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://AutomataOOO.github.io/automata_docs/docs/automata-signal/flows/sdk-initialization-flow"><link data-rh="true" rel="alternate" href="https://AutomataOOO.github.io/automata_docs/docs/automata-signal/flows/sdk-initialization-flow" hreflang="en"><link data-rh="true" rel="alternate" href="https://AutomataOOO.github.io/automata_docs/docs/automata-signal/flows/sdk-initialization-flow" hreflang="x-default"><link rel="stylesheet" href="/automata_docs/assets/css/styles.7a5bbb8d.css">
<script src="/automata_docs/assets/js/runtime~main.bd9108a2.js" defer="defer"></script>
<script src="/automata_docs/assets/js/main.4999a8a5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/automata_docs/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/automata_docs/"><div class="navbar__logo"><img src="/automata_docs/img/logo.svg" alt="Automata Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/automata_docs/img/logo.svg" alt="Automata Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Automata</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/automata_docs/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/automata_docs/docs/">Summary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/automata_docs/docs/automata-signal/">Automata-Signal</a><button aria-label="Collapse sidebar category &#x27;Automata-Signal&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/automata_docs/docs/automata-signal/architecture-overview">[ARCH-001] Automata-Signal 아키텍처 개요</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/automata_docs/docs/automata-signal/components/channel-adapters">components</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/automata_docs/docs/automata-signal/dictionaries/message-states">dictionaries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/automata_docs/docs/automata-signal/flows/message-processing-flow">flows</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/automata_docs/docs/automata-signal/flows/message-processing-flow">[FLOW-002] 메시지 처리 흐름</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/automata_docs/docs/automata-signal/flows/sdk-initialization-flow">[FLOW-001] SDK 초기화 및 사용자 식별 흐름</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/automata_docs/docs/automata-signal/requirements">[REQ-001] Automata-Signal 요구사항</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/automata_docs/docs/automata-signal/workspace-rules">Workspace rules - Automata-Signal</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/automata_docs/docs/global-rules">Global rules</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/automata_docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/automata_docs/docs/automata-signal/"><span itemprop="name">Automata-Signal</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">flows</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">[FLOW-001] SDK 초기화 및 사용자 식별 흐름</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>[FLOW-001] SDK 초기화 및 사용자 식별 흐름</h1></header>
<ul>
<li>문서 ID: FLOW-001</li>
<li>버전: 1.0</li>
<li>작성일: 2025-04-02</li>
<li>상태: 검토 중</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="요약">요약<a href="#요약" class="hash-link" aria-label="Direct link to 요약" title="Direct link to 요약">​</a></h2>
<p>본 문서는 Automata-Signal SDK의 초기화 과정, 사용자 식별(로그인/로그아웃), 그리고 다양한 메시징 채널 구독 관리에 대한 흐름을 설명합니다. SDK와 서버 간의 상호작용을 포함한 전체 프로세스를 상세히 다룹니다.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="대상-독자">대상 독자<a href="#대상-독자" class="hash-link" aria-label="Direct link to 대상 독자" title="Direct link to 대상 독자">​</a></h2>
<ul>
<li>모바일 앱 개발자</li>
<li>SDK 통합 담당자</li>
<li>백엔드 개발자</li>
<li>QA 팀</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="선행-지식">선행 지식<a href="#선행-지식" class="hash-link" aria-label="Direct link to 선행 지식" title="Direct link to 선행 지식">​</a></h2>
<ul>
<li>[ARCH-004] SDK 아키텍처</li>
<li>[DICT-001] 구독 상태 코드 사전</li>
<li>[API-001] 사용자 및 구독 API 명세</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-sdk-초기화-및-사용자-식별-흐름-다이어그램">1. SDK 초기화 및 사용자 식별 흐름 다이어그램<a href="#1-sdk-초기화-및-사용자-식별-흐름-다이어그램" class="hash-link" aria-label="Direct link to 1. SDK 초기화 및 사용자 식별 흐름 다이어그램" title="Direct link to 1. SDK 초기화 및 사용자 식별 흐름 다이어그램">​</a></h2>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-sdk-초기화-프로세스">2. SDK 초기화 프로세스<a href="#2-sdk-초기화-프로세스" class="hash-link" aria-label="Direct link to 2. SDK 초기화 프로세스" title="Direct link to 2. SDK 초기화 프로세스">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-초기화-파라미터">2.1 초기화 파라미터<a href="#21-초기화-파라미터" class="hash-link" aria-label="Direct link to 2.1 초기화 파라미터" title="Direct link to 2.1 초기화 파라미터">​</a></h3>
<p>SDK 초기화는 앱 시작 시 최대한 빨리 수행되어야 합니다:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Flutter SDK 초기화 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void main() async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  WidgetsFlutterBinding.ensureInitialized();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // SDK 초기화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await AutomataSignal().initialize(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;YOUR_APP_ID&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AutomataSignalConfig(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      autoRegisterPush: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      autoPromptPermission: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      foregroundNotificationsEnabled: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enableInAppMessages: true, // 인앱 메시지 활성화 (지원 예정)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      defaultLanguage: &#x27;ko&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      trackMessageEvents: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  runApp(MyApp());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>AutomataSignalConfig</code> 옵션:</p>
<table><thead><tr><th>옵션</th><th>타입</th><th>기본값</th><th>설명</th></tr></thead><tbody><tr><td>autoRegisterPush</td><td>bool</td><td>true</td><td>자동으로 푸시 알림 토큰 등록</td></tr><tr><td>autoPromptPermission</td><td>bool</td><td>true</td><td>자동으로 푸시 알림 권한 요청</td></tr><tr><td>foregroundNotificationsEnabled</td><td>bool</td><td>true</td><td>앱 포그라운드 상태에서도 알림 표시</td></tr><tr><td>enableInAppMessages</td><td>bool</td><td>true</td><td>인앱 메시지 활성화 (지원 예정)</td></tr><tr><td>defaultLanguage</td><td>String</td><td>null</td><td>기본 언어 설정</td></tr><tr><td>trackMessageEvents</td><td>bool</td><td>true</td><td>메시지 수신/열람 등 이벤트 자동 추적</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-내부-초기화-단계">2.2 내부 초기화 단계<a href="#22-내부-초기화-단계" class="hash-link" aria-label="Direct link to 2.2 내부 초기화 단계" title="Direct link to 2.2 내부 초기화 단계">​</a></h3>
<p>SDK의 내부 초기화 과정은 다음 순서로 진행됩니다:</p>
<ol>
<li>앱 ID 및 설정 저장</li>
<li>필요한 매니저 클래스 초기화:<!-- -->
<ul>
<li>SubscriptionManager: 구독 관리</li>
<li>UserManager: 사용자 식별 관리</li>
<li>MessageManager: 메시지 처리 및 추적</li>
<li>InAppMessageManager: 인앱 메시지 관리 (지원 예정)</li>
</ul>
</li>
<li>디바이스 정보 수집:<!-- -->
<ul>
<li>디바이스 모델</li>
<li>OS 버전</li>
<li>앱 버전</li>
<li>SDK 버전</li>
<li>언어 설정</li>
<li>국가 코드</li>
<li>타임존</li>
</ul>
</li>
</ol>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 내부 초기화 로직 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Future&lt;void&gt; _initialize(String appId, AutomataSignalConfig config) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _appId = appId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _config = config;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 디바이스 정보 수집</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _deviceInfo = await _collectDeviceInfo();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 구독 관리자 초기화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _subscriptionManager = SubscriptionManager(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    appId: appId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deviceInfo: _deviceInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 사용자 관리자 초기화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _userManager = UserManager(appId: appId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 메시지 관리자 초기화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _messageManager = MessageManager(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    appId: appId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    trackEvents: config.trackMessageEvents</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 저장된 사용자 ID가 있는 경우 자동 복원</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await _restoreUserIfAvailable();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 자동 푸시 알림 등록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (config.autoRegisterPush) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await _registerPushNotifications(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      promptPermission: config.autoPromptPermission</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-푸시-알림-등록-프로세스">2.3 푸시 알림 등록 프로세스<a href="#23-푸시-알림-등록-프로세스" class="hash-link" aria-label="Direct link to 2.3 푸시 알림 등록 프로세스" title="Direct link to 2.3 푸시 알림 등록 프로세스">​</a></h3>
<p>자동 등록이 활성화된 경우 푸시 알림 등록 과정:</p>
<ol>
<li>플랫폼별 푸시 서비스 초기화:<!-- -->
<ul>
<li>iOS: APNS(Apple Push Notification Service)</li>
<li>Android: FCM(Firebase Cloud Messaging)</li>
</ul>
</li>
<li>디바이스 토큰 요청</li>
<li>토큰을 서버에 등록하여 새로운 구독 생성</li>
<li>(옵션) 사용자에게 알림 권한 요청</li>
</ol>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 푸시 알림 등록 로직 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Future&lt;void&gt; _registerPushNotifications({bool promptPermission = true}) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 플랫폼별 초기화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (Platform.isIOS) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await _initializeAPNS();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } else if (Platform.isAndroid) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await _initializeFCM();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 토큰 요청</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  String? token = await _getPushToken();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (token != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 토큰을 서버에 등록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await _subscriptionManager.registerPushSubscription(token);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 권한 요청</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (promptPermission) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bool granted = await _requestNotificationPermission();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 권한 상태 서버에 업데이트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (token != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      await _subscriptionManager.updateSubscriptionStatus(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        token,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        granted ? 1 : -22  // -22: 수동 구독 취소</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="24-서버-api-요청">2.4 서버 API 요청<a href="#24-서버-api-요청" class="hash-link" aria-label="Direct link to 2.4 서버 API 요청" title="Direct link to 2.4 서버 API 요청">​</a></h3>
<p>SDK 초기화 중 서버로 보내는 API 요청 예시:</p>
<p><strong>푸시 알림 구독 등록 요청 (POST /api/v1/subscriptions)</strong></p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;application_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;YOUR_APP_ID&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;iOSPush&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 또는 &quot;AndroidPush&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;device_push_token_here&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;device_info&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;device_model&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;iPhone 13&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;device_os&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;iOS 15.4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;device_language&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ko&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;app_version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;sdk_version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;country_code&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;KR&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;test_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>응답:</strong></p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;subscription_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a1b2c3d4-e5f6-7890-abcd-ef1234567890&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;success&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-사용자-식별-프로세스">3. 사용자 식별 프로세스<a href="#3-사용자-식별-프로세스" class="hash-link" aria-label="Direct link to 3. 사용자 식별 프로세스" title="Direct link to 3. 사용자 식별 프로세스">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-로그인-프로세스">3.1 로그인 프로세스<a href="#31-로그인-프로세스" class="hash-link" aria-label="Direct link to 3.1 로그인 프로세스" title="Direct link to 3.1 로그인 프로세스">​</a></h3>
<p>사용자가 앱에 로그인할 때 SDK를 통해 사용자를 식별합니다:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 사용자 로그인 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Future&lt;void&gt; onUserLogin(String userId) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await AutomataSignal().login(userId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;User identified successfully&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 로그인 후 인앱 메시지 확인 (지원 예정)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await AutomataSignal().fetchInAppMessages();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } catch (error) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;Failed to identify user: $error&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>내부적으로 다음 단계가 수행됩니다:</p>
<ol>
<li>사용자 ID를 검증하고 저장</li>
<li>서버에 사용자 식별 요청 전송</li>
<li>서버가 User 레코드를 찾거나 생성</li>
<li>현재 구독과 사용자를 연결</li>
<li>성공 시 로컬에 사용자 ID 캐싱 (앱 재시작 시 자동 복원용)</li>
</ol>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 내부 사용자 식별 로직 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Future&lt;void&gt; identifyUser(String externalId) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (externalId.isEmpty) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throw Exception(&#x27;User ID cannot be empty&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 서버에 사용자 식별 요청</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final response = await _apiClient.post(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;/api/v1/users/identify&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      body: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;application_id&#x27;: _appId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;external_id&#x27;: externalId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;subscriptions&#x27;: await _subscriptionManager.getSubscriptionIds()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (response[&#x27;status&#x27;] == &#x27;success&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // 로컬에 사용자 ID 저장</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      _externalId = externalId;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      _automataId = response[&#x27;user_id&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      await _storage.setString(&#x27;user_external_id&#x27;, externalId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      _isIdentified = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    throw Exception(&#x27;Failed to identify user: ${response[&#x27;error&#x27;]}&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } catch (error) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _isIdentified = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rethrow;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-서버-측-식별-처리">3.2 서버 측 식별 처리<a href="#32-서버-측-식별-처리" class="hash-link" aria-label="Direct link to 3.2 서버 측 식별 처리" title="Direct link to 3.2 서버 측 식별 처리">​</a></h3>
<p>서버에서는 사용자 식별 요청을 다음과 같이 처리합니다:</p>
<ol>
<li><code>application_id</code>와 <code>external_id</code>를 기반으로 기존 사용자 검색</li>
<li>사용자가 없는 경우 새 User 레코드 생성</li>
<li>요청에 포함된 구독 ID를 사용자와 연결</li>
<li>관련 메타데이터 업데이트 (마지막 활성 시간 등)</li>
</ol>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 서버 측 사용자 식별 처리 로직 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def identify_user(params) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Ash.transaction(fn -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 사용자 찾기 또는 생성</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      case find_user_by_external_id(params.application_id, params.external_id) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        nil -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # 새 사용자 생성</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          User.create_changeset(%{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            external_id: params.external_id,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            application_id: params.application_id,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            last_active_at: DateTime.utc_now()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          |&gt; Ash.create!()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        existing_user -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # 기존 사용자 업데이트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          existing_user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          |&gt; User.update_changeset(%{last_active_at: DateTime.utc_now()})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          |&gt; Ash.update!()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 구독과 사용자 연결</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link_subscriptions_to_user(user.id, params.subscriptions)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 성공 응답 반환</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    %{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status: &quot;success&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      user_id: user.id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-로그아웃-프로세스">3.3 로그아웃 프로세스<a href="#33-로그아웃-프로세스" class="hash-link" aria-label="Direct link to 3.3 로그아웃 프로세스" title="Direct link to 3.3 로그아웃 프로세스">​</a></h3>
<p>사용자가 앱에서 로그아웃할 때:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 사용자 로그아웃 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Future&lt;void&gt; onUserLogout() async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await AutomataSignal().logout();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;User logged out successfully&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } catch (error) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;Failed to logout user: $error&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>내부적으로 다음 단계가 수행됩니다:</p>
<ol>
<li>서버에 로그아웃 요청 전송</li>
<li>현재 구독과 사용자 연결 해제</li>
<li>로컬에 저장된 사용자 ID 삭제</li>
<li>인앱 메시지 캐시 제거 (지원 예정)</li>
</ol>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 내부 로그아웃 로직 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Future&lt;void&gt; logoutUser() async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (!_isIdentified) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return; // 이미 로그아웃 상태</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 서버에 로그아웃 요청</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await _apiClient.post(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &#x27;/api/v1/users/logout&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      body: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;application_id&#x27;: _appId,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &#x27;subscriptions&#x27;: await _subscriptionManager.getSubscriptionIds()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 로컬 사용자 정보 제거</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _externalId = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _automataId = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await _storage.remove(&#x27;user_external_id&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 인앱 메시지 캐시 제거 (지원 예정)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await _inAppMessageManager?.clearCache();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _isIdentified = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } catch (error) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 오류는 기록하되, 로컬 로그아웃은 진행</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;Error during logout: $error&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _externalId = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _automataId = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await _storage.remove(&#x27;user_external_id&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _isIdentified = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rethrow;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-서버-측-로그아웃-처리">3.4 서버 측 로그아웃 처리<a href="#34-서버-측-로그아웃-처리" class="hash-link" aria-label="Direct link to 3.4 서버 측 로그아웃 처리" title="Direct link to 3.4 서버 측 로그아웃 처리">​</a></h3>
<p>서버에서는 로그아웃 요청을 다음과 같이 처리합니다:</p>
<ol>
<li>요청에 포함된 구독 ID를 사용자와 연결 해제</li>
<li>구독 상태는 유지하되 User ID 참조만 제거</li>
<li>익명 사용자 상태로 되돌림</li>
</ol>
<div class="language-elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-elixir codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 서버 측 로그아웃 처리 로직 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def logout_user(params) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Ash.transaction(fn -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 구독과 사용자 연결 해제</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    unlink_subscriptions_from_user(params.subscriptions)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 성공 응답 반환</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    %{status: &quot;success&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">defp unlink_subscriptions_from_user(subscription_ids) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Enum.each(subscription_ids, fn subscription_id -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    subscription = Subscription.get!(subscription_id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    subscription</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |&gt; Subscription.update_changeset(%{user_id: nil})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |&gt; Ash.update!()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 구독 상태 변경 이벤트 기록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SubscriptionEvent.create_changeset(%{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      subscription_id: subscription.id,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      application_id: subscription.application_id,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      event_type: :user_unlinked,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      reason: &quot;user_logout&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      occurred_at: DateTime.utc_now()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |&gt; Ash.create!()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-채널-구독-관리">4. 채널 구독 관리<a href="#4-채널-구독-관리" class="hash-link" aria-label="Direct link to 4. 채널 구독 관리" title="Direct link to 4. 채널 구독 관리">​</a></h2>
<p>SDK는 다양한 메시징 채널의 구독을 관리하는 기능을 제공합니다.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-푸시-알림-구독-관리">4.1 푸시 알림 구독 관리<a href="#41-푸시-알림-구독-관리" class="hash-link" aria-label="Direct link to 4.1 푸시 알림 구독 관리" title="Direct link to 4.1 푸시 알림 구독 관리">​</a></h3>
<p>SDK 초기화 시 자동으로 등록되는 푸시 알림 구독을 관리하는 메서드:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 푸시 알림 비활성화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().disablePush();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 푸시 알림 활성화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().enablePush();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 푸시 토큰 수동 업데이트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().updatePushToken(&quot;new_token_here&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>내부적으로 구독 상태가 업데이트됩니다:</p>
<ul>
<li>활성화: <code>subscription_status</code> 값을 1로 설정</li>
<li>비활성화: <code>subscription_status</code> 값을 -2로 설정 (사용자에 의한 구독 취소)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-이메일-구독-관리-지원-예정">4.2 이메일 구독 관리 (지원 예정)<a href="#42-이메일-구독-관리-지원-예정" class="hash-link" aria-label="Direct link to 4.2 이메일 구독 관리 (지원 예정)" title="Direct link to 4.2 이메일 구독 관리 (지원 예정)">​</a></h3>
<p>이메일 채널 구독 등록 및 관리:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 이메일 구독 등록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String? subscriptionId = await AutomataSignal().registerEmail(&quot;user@example.com&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 이메일 구독 비활성화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().disableChannel(SubscriptionType.Email);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 이메일 구독 활성화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().enableChannel(SubscriptionType.Email);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>이메일 구독 등록 API 요청:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /api/v1/subscriptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;application_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;YOUR_APP_ID&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Email&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user@example.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;user_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;optional_user_id_if_logged_in&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-sms-구독-관리-지원-예정">4.3 SMS 구독 관리 (지원 예정)<a href="#43-sms-구독-관리-지원-예정" class="hash-link" aria-label="Direct link to 4.3 SMS 구독 관리 (지원 예정)" title="Direct link to 4.3 SMS 구독 관리 (지원 예정)">​</a></h3>
<p>SMS 채널 구독 등록 및 관리:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SMS 구독 등록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String? subscriptionId = await AutomataSignal().registerSMS(&quot;+821012345678&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// SMS 구독 비활성화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().disableChannel(SubscriptionType.SMS);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// SMS 구독 활성화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().enableChannel(SubscriptionType.SMS);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-카카오-알림톡-구독-관리-지원-예정">4.4 카카오 알림톡 구독 관리 (지원 예정)<a href="#44-카카오-알림톡-구독-관리-지원-예정" class="hash-link" aria-label="Direct link to 4.4 카카오 알림톡 구독 관리 (지원 예정)" title="Direct link to 4.4 카카오 알림톡 구독 관리 (지원 예정)">​</a></h3>
<p>카카오 알림톡 채널 구독 등록 및 관리:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 카카오 알림톡 구독 등록</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String? subscriptionId = await AutomataSignal().registerKakaoTalk(&quot;+821012345678&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 카카오 알림톡 구독 비활성화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().disableChannel(SubscriptionType.KakaoTalk);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 카카오 알림톡 구독 활성화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().enableChannel(SubscriptionType.KakaoTalk);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="45-인앱-메시지-구독-관리-지원-예정">4.5 인앱 메시지 구독 관리 (지원 예정)<a href="#45-인앱-메시지-구독-관리-지원-예정" class="hash-link" aria-label="Direct link to 4.5 인앱 메시지 구독 관리 (지원 예정)" title="Direct link to 4.5 인앱 메시지 구독 관리 (지원 예정)">​</a></h3>
<p>인앱 메시지 채널 구독 관리:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 인앱 메시지 비활성화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().disableChannel(SubscriptionType.InAppMessage);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 인앱 메시지 활성화</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().enableChannel(SubscriptionType.InAppMessage);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-태그-관리">5. 태그 관리<a href="#5-태그-관리" class="hash-link" aria-label="Direct link to 5. 태그 관리" title="Direct link to 5. 태그 관리">​</a></h2>
<p>사용자의 구독에 태그를 추가하여 세그먼트 기반 메시징을 지원합니다:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 태그 추가</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().addTags({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;premium_user&quot;: &quot;true&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;user_level&quot;: &quot;silver&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;favorite_category&quot;: &quot;electronics&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 태그 제거</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">await AutomataSignal().removeTags([&quot;user_level&quot;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 태그 조회</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Map&lt;String, String&gt; tags = await AutomataSignal().getTags();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>태그 추가 API 요청:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /api/v1/subscriptions/tags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;application_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;YOUR_APP_ID&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;subscription_ids&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;subscription_id1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;subscription_id2&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;tags&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;premium_user&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;user_level&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;silver&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;favorite_category&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;electronics&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-데이터-지속성">6. 데이터 지속성<a href="#6-데이터-지속성" class="hash-link" aria-label="Direct link to 6. 데이터 지속성" title="Direct link to 6. 데이터 지속성">​</a></h2>
<p>SDK는 다음 데이터를 로컬에 저장합니다:</p>
<ol>
<li>
<p><strong>구독 정보</strong>:</p>
<ul>
<li>구독 ID</li>
<li>채널 유형</li>
<li>토큰 값</li>
<li>구독 상태</li>
</ul>
</li>
<li>
<p><strong>사용자 정보</strong>:</p>
<ul>
<li>외부 사용자 ID (앱 재시작 시 자동 복원용)</li>
<li>Automata 사용자 ID</li>
</ul>
</li>
<li>
<p><strong>메시지 추적 데이터</strong>:</p>
<ul>
<li>처리 중인 메시지 ID</li>
<li>수신 확인 대기 중인 메시지 큐</li>
<li>네트워크 연결 없을 때 캐시된 이벤트</li>
</ul>
</li>
<li>
<p><strong>인앱 메시지 데이터</strong> (지원 예정):</p>
<ul>
<li>캐싱된 인앱 메시지</li>
<li>표시 규칙 및 트리거</li>
</ul>
</li>
</ol>
<p>데이터 지속성 구현:</p>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 구독 정보 저장 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Future&lt;void&gt; _saveSubscriptionInfo(SubscriptionInfo subscription) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final subscriptions = await _getStoredSubscriptions();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  subscriptions[subscription.id] = subscription.toJson();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  await _storage.setString(&#x27;subscriptions&#x27;, jsonEncode(subscriptions));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 구독 정보 복원 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Future&lt;Map&lt;String, SubscriptionInfo&gt;&gt; _getStoredSubscriptions() async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  final data = await _storage.getString(&#x27;subscriptions&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (data == null || data.isEmpty) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return {};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    final Map&lt;String, dynamic&gt; jsonData = jsonDecode(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return jsonData.map((key, value) =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      MapEntry(key, SubscriptionInfo.fromJson(value))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  } catch (e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(&#x27;Error restoring subscriptions: $e&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return {};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-오류-처리-및-재시도">7. 오류 처리 및 재시도<a href="#7-오류-처리-및-재시도" class="hash-link" aria-label="Direct link to 7. 오류 처리 및 재시도" title="Direct link to 7. 오류 처리 및 재시도">​</a></h2>
<p>SDK는 네트워크 오류나 서버 문제 시 다음과 같은 전략을 사용합니다:</p>
<ol>
<li>
<p><strong>지수 백오프 재시도</strong>:</p>
<ul>
<li>초기 재시도 간격: 1초</li>
<li>최대 재시도 간격: 60초</li>
<li>최대 재시도 횟수: 5회</li>
</ul>
</li>
<li>
<p><strong>오프라인 작업 큐</strong>:</p>
<ul>
<li>네트워크 연결이 없을 때 작업 큐에 저장</li>
<li>연결 복원 시 큐의 작업 처리</li>
</ul>
</li>
<li>
<p><strong>오류 분류</strong>:</p>
<ul>
<li>네트워크 오류: 재시도 가능</li>
<li>인증 오류: 재인증 필요</li>
<li>서버 오류: 상황에 따라 재시도</li>
<li>클라이언트 오류: 재시도 불가</li>
</ul>
</li>
</ol>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 오류 처리 및 재시도 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Future&lt;T&gt; _retryableRequest&lt;T&gt;(Future&lt;T&gt; Function() request) async {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int attempt = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Duration delay = Duration(seconds: 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return await request();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch (e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      attempt++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if (!_shouldRetry(e) || attempt &gt;= 5) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rethrow;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // 지수 백오프 대기</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      await Future.delayed(delay);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      delay = Duration(seconds: min(60, delay.inSeconds * 2));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bool _shouldRetry(dynamic error) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (error is NetworkError) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (error is ServerError &amp;&amp; error.statusCode &gt;= 500) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-보안-고려사항">8. 보안 고려사항<a href="#8-보안-고려사항" class="hash-link" aria-label="Direct link to 8. 보안 고려사항" title="Direct link to 8. 보안 고려사항">​</a></h2>
<p>SDK 구현 시 다음과 같은 보안 사항을 고려합니다:</p>
<ol>
<li>
<p><strong>인증 토큰 보안</strong>:</p>
<ul>
<li>토큰은 앱의 안전한 저장소에 암호화하여 저장</li>
<li>메모리에서 필요한 시간만 유지</li>
</ul>
</li>
<li>
<p><strong>API 통신 보안</strong>:</p>
<ul>
<li>모든 API 통신은 HTTPS/TLS 사용</li>
<li>인증 헤더 및 토큰을 통한 API 요청 인증</li>
</ul>
</li>
<li>
<p><strong>개인정보 보호</strong>:</p>
<ul>
<li>필요한 최소한의 개인 정보만 수집 및 전송</li>
<li>민감한 정보는 서버에 직접 저장하지 않음</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-디버깅-및-로깅">9. 디버깅 및 로깅<a href="#9-디버깅-및-로깅" class="hash-link" aria-label="Direct link to 9. 디버깅 및 로깅" title="Direct link to 9. 디버깅 및 로깅">​</a></h2>
<p>SDK는 다음과 같은 디버깅 지원을 제공합니다:</p>
<ol>
<li>
<p><strong>로그 레벨 설정</strong>:</p>
<ul>
<li>VERBOSE: 상세한 디버깅 정보</li>
<li>DEBUG: 디버깅 정보</li>
<li>INFO: 일반 정보 (기본값)</li>
<li>WARNING: 경고</li>
<li>ERROR: 오류</li>
<li>NONE: 로깅 비활성화</li>
</ul>
</li>
<li>
<p><strong>SDK 상태 확인</strong>:</p>
<ul>
<li>구독 상태 및 ID 조회</li>
<li>사용자 식별 상태 확인</li>
<li>푸시 토큰 정보</li>
</ul>
</li>
</ol>
<div class="language-dart codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-dart codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 로그 레벨 설정 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AutomataSignal().setLogLevel(LogLevel.DEBUG);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// SDK 상태 확인 예시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bool isIdentified = await AutomataSignal().isUserIdentified();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">List&lt;SubscriptionInfo&gt; subscriptions = await AutomataSignal().getSubscriptions();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String? pushToken = await AutomataSignal().getPushToken();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="관련-문서">관련 문서<a href="#관련-문서" class="hash-link" aria-label="Direct link to 관련 문서" title="Direct link to 관련 문서">​</a></h2>
<ul>
<li>[ARCH-004] SDK 아키텍처</li>
<li>[DICT-001] 구독 상태 코드 사전</li>
<li>[API-001] 사용자 및 구독 API 명세</li>
<li>[FLOW-002] 메시지 처리 흐름</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="변경-이력">변경 이력<a href="#변경-이력" class="hash-link" aria-label="Direct link to 변경 이력" title="Direct link to 변경 이력">​</a></h2>
<table><thead><tr><th>버전</th><th>날짜</th><th>변경 내용</th></tr></thead><tbody><tr><td>1.0</td><td>2025-04-02</td><td>최초 문서 작성</td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/AutomataOOO/automata_docs/tree/main/docs/automata-signal/flows/sdk-initialization-flow.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/automata_docs/docs/automata-signal/flows/message-processing-flow"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">[FLOW-002] 메시지 처리 흐름</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/automata_docs/docs/automata-signal/requirements"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">[REQ-001] Automata-Signal 요구사항</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#요약" class="table-of-contents__link toc-highlight">요약</a></li><li><a href="#대상-독자" class="table-of-contents__link toc-highlight">대상 독자</a></li><li><a href="#선행-지식" class="table-of-contents__link toc-highlight">선행 지식</a></li><li><a href="#1-sdk-초기화-및-사용자-식별-흐름-다이어그램" class="table-of-contents__link toc-highlight">1. SDK 초기화 및 사용자 식별 흐름 다이어그램</a></li><li><a href="#2-sdk-초기화-프로세스" class="table-of-contents__link toc-highlight">2. SDK 초기화 프로세스</a><ul><li><a href="#21-초기화-파라미터" class="table-of-contents__link toc-highlight">2.1 초기화 파라미터</a></li><li><a href="#22-내부-초기화-단계" class="table-of-contents__link toc-highlight">2.2 내부 초기화 단계</a></li><li><a href="#23-푸시-알림-등록-프로세스" class="table-of-contents__link toc-highlight">2.3 푸시 알림 등록 프로세스</a></li><li><a href="#24-서버-api-요청" class="table-of-contents__link toc-highlight">2.4 서버 API 요청</a></li></ul></li><li><a href="#3-사용자-식별-프로세스" class="table-of-contents__link toc-highlight">3. 사용자 식별 프로세스</a><ul><li><a href="#31-로그인-프로세스" class="table-of-contents__link toc-highlight">3.1 로그인 프로세스</a></li><li><a href="#32-서버-측-식별-처리" class="table-of-contents__link toc-highlight">3.2 서버 측 식별 처리</a></li><li><a href="#33-로그아웃-프로세스" class="table-of-contents__link toc-highlight">3.3 로그아웃 프로세스</a></li><li><a href="#34-서버-측-로그아웃-처리" class="table-of-contents__link toc-highlight">3.4 서버 측 로그아웃 처리</a></li></ul></li><li><a href="#4-채널-구독-관리" class="table-of-contents__link toc-highlight">4. 채널 구독 관리</a><ul><li><a href="#41-푸시-알림-구독-관리" class="table-of-contents__link toc-highlight">4.1 푸시 알림 구독 관리</a></li><li><a href="#42-이메일-구독-관리-지원-예정" class="table-of-contents__link toc-highlight">4.2 이메일 구독 관리 (지원 예정)</a></li><li><a href="#43-sms-구독-관리-지원-예정" class="table-of-contents__link toc-highlight">4.3 SMS 구독 관리 (지원 예정)</a></li><li><a href="#44-카카오-알림톡-구독-관리-지원-예정" class="table-of-contents__link toc-highlight">4.4 카카오 알림톡 구독 관리 (지원 예정)</a></li><li><a href="#45-인앱-메시지-구독-관리-지원-예정" class="table-of-contents__link toc-highlight">4.5 인앱 메시지 구독 관리 (지원 예정)</a></li></ul></li><li><a href="#5-태그-관리" class="table-of-contents__link toc-highlight">5. 태그 관리</a></li><li><a href="#6-데이터-지속성" class="table-of-contents__link toc-highlight">6. 데이터 지속성</a></li><li><a href="#7-오류-처리-및-재시도" class="table-of-contents__link toc-highlight">7. 오류 처리 및 재시도</a></li><li><a href="#8-보안-고려사항" class="table-of-contents__link toc-highlight">8. 보안 고려사항</a></li><li><a href="#9-디버깅-및-로깅" class="table-of-contents__link toc-highlight">9. 디버깅 및 로깅</a></li><li><a href="#관련-문서" class="table-of-contents__link toc-highlight">관련 문서</a></li><li><a href="#변경-이력" class="table-of-contents__link toc-highlight">변경 이력</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Automata, Inc.</div></div></div></footer></div>
</body>
</html>